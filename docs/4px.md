# 4PX Fulfillment Service API

Using the 4PX API to make it as fulfillment provider in Medusa V2.

## OAuth Authorization

### Obtain the Authorization Code

- **HTTP Method:** `GET`
- **Request URL:** `https://open.4px.com/authorize/get`
- **Request Parameters:**

| Field         | Type   | Required | Description |
|---------------|--------|----------|-------------|
| client_id     | String | Yes      | The `app_key` generated by the system when the App was registered |
| response_type | String | Yes      | Must be `code`; this is required by the OAuth specification |
| redirect_uri  | String | Yes      | Callback URL after successful authorization; must be URL-encoded |

- **Example Request URL:** https://open.4px.com/authorize/get?client_id=<FOURPX_API_KEY>&response_type=code&redirect_uri=http%3A%2F%2Fwww.yourstore.com

If authorization is successful, the authorization server will redirect the user to the `redirect_uri`

### Retrieve Access Token from Authorization Code

- **HTTP Method:** `POST`
- **Request URL:** `https://open.4px.com/accessToken/get`
- **Content-Type:** `application/x-www-form-urlencoded`
- **Request Parameters:**

| Field         | Type   | Required | Description |
|---------------|--------|----------|-------------|
| client_id     | String | Yes      | The `app_key` generated when registering the App |
| client_secret | String | Yes      | The `app_secret` generated when registering the App |
| grant_type    | String | Yes      | Default value: `authorization_code` |
| code          | String | Yes      | The `code` value returned from the authorization step (one-time use) |
| redirect_uri  | String | Yes      | The callback URL domain used during App registration. Must be the same domain or top-level domain as the one used when requesting authorization. |

### Response Parameters

| Field         | Type   | Description |
|----------------|--------|-------------|
| expires_in     | Number | Expiration time of the `access_token` in milliseconds |
| access_token   | String | Authorization token, valid for 7 days |
| refresh_token  | String | Refresh token, valid for 1 year |

### Retrieve new Access Token from Refresh Token

1. If the **refresh_token** is still valid and the **access_token** has expired, you may use the `refresh_token` to obtain a new `access_token` without re-authorizing.
2. If the **refresh_token** has expired, you must restart the OAuth 2.0 authorization process to obtain a new token.

- **HTTP Method:** `POST`
- **Request URL:** `https://open.4px.com/accessToken/get`
- **Content-Type:** `application/x-www-form-urlencoded`
- **Request Parameters:**

| Field         | Type   | Required | Description |
|---------------|--------|----------|-------------|
| client_id     | String | Yes      | The `app_key` generated by the system when registering the application |
| client_secret | String | Yes      | The `app_secret` generated by the system when registering the application |
| grant_type    | String | Yes      | Must be `refresh_token` |
| refresh_token | String | Yes      | The `refresh_token` value returned from the previous step |
| redirect_uri  | String | Yes      | The callback URL domain registered for the application. Must match the callback domain used during authorization or share the same top-level domain. |

- **Response Parameters:** The response fields are the same as the response for obtaining the initial `access_token`, and will not be repeated here.

---

## Generalized API Request Approach

### Public Request Parameters

| Field        | Type   | Required | Description |
|--------------|--------|----------|-------------|
| method       | String | Yes      | API method name |
| app_key      | String | Yes      | AppKey assigned when registering the application |
| v            | String | Yes      | API protocol version; refer to the interface version number |
| timestamp    | String | Yes      | Timestamp in milliseconds. Example: `2018-07-26 16:06:53:187` → `1532592413187` |
| format       | String | Yes      | Business data format. Default: `json`; allowed value: `json`. |
| sign         | String | Yes      | Signature of API input parameters; encrypted using the App Secret via MD5 |
| access_token | String | Yes      | Obtained via OAuth; required for platform service providers & third-party vendors; optional for 4PX category-B customers |
| language     | String | No       | Response language. Supported: `cn` (Chinese), `en` (English) |

### Signature Generation Rule

- Sort all parameters in ascending alphabetical order by their first letter.
- `access_token` and `language` are not included in the signature generation process.
- Remove all `=` and `&` symbols, then concatenate each parameter name directly with its value.
- After that, append the body content and the appSecret at the end.
- Assume:
  - appSecret = `7eebf328-8e5a-4030-904d-ec6e89174fbc`
  - Body content (JSON compact form): `{"aa":"bb"}`
- The resulting concatenated string becomes: `app_key16081f05-e8fc-4250-b9c4-0660d1ecbb28formatjsonmethodds.xms.order.createtimestamp1532592413187v1.0{"aa":"bb"}7eebf328-8e5a-4030-904d-ec6e89174fbc`
- Finally, generate a 32-character lowercase MD5 signature (sign) from the concatenated string. (All signatures must use the MD5 algorithm.)

### Calling API

Now you may start calling the API.

- **HTTP Method:** `POST`
- **Request URL:** `https://open.4px.com/router/api/service`
- **Content-Type:** `application/json`
- **Public Request Parameters:** These parameters are appended to the URL and joined with `&`.

### Body Request Parameters

Place these parameters in the **request body**, formatted as **JSON**.

## Example Using the Generated Parameters

- **Example Request URL:** https://open.4px.com/router/api/service?method=ds.xms.order.create&app_key=<FOURPX_API_KEY>&v=1.0&timestamp=1532592413187&format=json&sign=c4a41de412206ad4473c72f273082f92

### Notes
1. The API domain:
   - **Test environment:** `open-test.4px.com`
   - **Production environment:** `open.4px.com`

2. The parameters `method`, `app_key`, and all fields used for computing the signature must match exactly.  
The `sign` parameter is the MD5 value generated from the signature generation process.


### Production Usage & Code Example

#### After completing integration testing successfully, you may call the API in production.

- **HTTP Method:** `POST`
- **Request URL:** `https://open.4px.com/router/api/service`
- **Content-Type:** `application/json`
- These parameters are appended to the URL, joined using `&`. For example: https://open.4px.com/router/api/service?method=ds.xms.order.create&app_key=16081f05-e8fc-4250-b9c4-0660d1ecbb28&v=1.0&timestamp=1532592413187&format=json&sign=c4a41de412206ad4473c72f273082f92

| Field        | Type   | Required | Description                                                                                                                                  |
|--------------|--------|----------|----------------------------------------------------------------------------------------------------------------------------------------------|
| method       | String | Yes      | API method name                                                                                                                              |
| app_key      | String | Yes      | AppKey generated during application registration                                                                                             |
| v            | String | Yes      | API protocol version; refer to the interface version number                                                                                  |
| timestamp    | String | Yes      | Timestamp in milliseconds. Example: `2018-07-26 16:06:53:187` → `1532592413187`                                                              |
| format       | String | Yes      | Business data format. Default: `json`                                                                                                        |
| sign         | String | Yes      | Signature of API parameters; generated using App Secret + MD5 encryption                                                                     |
| access_token | String | Yes      | Token obtained via OAuth authorization. Required for platform service providers and third-party vendors; optional for 4PX business customers |
| language     | String | No       | Response language: `cn` (Chinese), `en` (English)                                                                                            |

- **Body Parameters:** Placed in the request body, formatted as JSON.

### Generic API Response

| Field  | Type   | Description |
|--------|--------|-------------|
| result | String | Response result: `0` = failed, `1` = successful, `2` = partially successful |
| msg    | String | Description message |
| data   | String | Returned content |

#### Notes
1. The request and response message bodies use JSON format.
2. The top-level JSON structure in the response is fixed.  
3. Only the `errors` and `data` nodes will vary depending on the response content.

### Generic Error Codes

| Error Code | Description                    | Solution |
|------------|--------------------------------|----------|
| 000012     | Signature verification error   | Refer to the API documentation and verify whether the signature string is correctly formatted. |
| 000004     | JSON parsing failed            | Check whether the request body conforms to JSON format requirements. |
| 000013     | app_key validation failed      | Check whether the app_key is correct. |
| 000014     | Invalid authentication parameters | Refer to the API documentation and verify whether the parameters meet the requirements. |
| 000011     | API interface does not exist   | Check whether the API method name is correct. |
| 000015     | API interface unavailable      | Contact technical support. |
| 000016     | API interface not authorized   | Contact technical support for authorization. |
| 000017     | Too many requests; try again in one minute | Please try again in one minute. |
| 000018     | APP does not exist             | Log in to the backend and verify whether the APP has been created. |
| 000019     | Rate limiting policy not configured | Contact technical support. |
| 000020     | Request timeout or exception   | Try again later or contact technical support. |
| 000021     | User does not match the APP    | Log in to the backend and verify whether the correct APP is configured. |
| 000022     | User not authorized            | Contact technical support for authorization. |
| 000023     | User unavailable               | Contact technical support. |
| 000024     | Service provider API returned 404 | Try again later or contact technical support to confirm whether the API exists. |
| 000025     | User type does not match the API | Contact technical support. |

---

**NOTE:** The following API are not require access_token.

## Create Direct-Shipment Entrust Order (ds.xms.order.create)

Calling this API allows you to create a direct-shipment service forecast order and issue a parcel-level direct-shipment entrust order.
- Version 1.0.0: Public version

### Request Parameters

| Field           | Type   | Max Length | Required | Example         | Description |
|-----------------|--------|------------|----------|-----------------|-------------|
| 4px_tracking_no | String | 64         | false       | 300482723836    | 4PX tracking number (customers with pre-allocated number segments may pass this value) |
| ref_no          | String | 64         | true      | RF760473585SG   | Reference number (customer’s own system order number, such as customer order ID) |
| label_barcode   | String | 64         | false       | 3000000000001   | Label barcode (customers with pre-allocated number segments may pass this value) |
| business_type   | String | 10         | true      | BDS             | Business type (required for internal 4PX dispatching; if integration requires passing this field it will be specified; default: `BDS`) |
| duty_type       | String | 10         | true      | U               | Duty payment type (`U`: DDU – recipient pays duties; `P`: DDP – sender pays duties). If the logistics product only supports one type, follow 4PX’s specification. |
| cargo_type      | String | 10         | false       | 5               | Cargo type (`1`: Gift; `2`: Document; `3`: Product sample; `5`: Other; default: `5`) |
| vat_no        | String | 32         | false       | SDF2324            | VAT number (letters or digits); VAT number used in EU countries (including the UK). |
| mid           | String | 32         | false       | USABC236ERL        | MID code, required for U.S. import customs clearance. Used as substitute information for the manufacturer, shipper, or exporter’s full name and address. Mandatory for formal U.S. customs declaration; must appear on the commercial invoice for U.S. imports. |
| csp           | String | 32         | false       | 12345-6            | CSP tax settlement account used for imports into Switzerland. |
| eori_no       | String | 32         | false       | SDF2324            | EORI number (letters or digits); required for customs clearance when entering the EU. |
| ioss_no       | String | 32         | false       | FR-123456          | IOSS number. |
| buyer_id      | String | 64         | false       | 23432432432432sd   | Buyer ID (letters or digits). |
| sales_platform| String | 128        | false       | AMAZON             | Sales platform (e.g., major e-commerce platforms or independent sites). |
| trade_id      | String | 32         | false       | csd2342344         | Transaction ID (letters or digits). |
| seller_id     | String | 32         | false       | csd2342344         | Seller ID (letters or digits). |
| is_commercial_invoice     | String | 3          | false       | N       | Indicates whether a commercial invoice can be provided (`Y`/`N`). `Y`: The customer can provide a commercial invoice (the system will NOT generate a proforma invoice). `N`: The customer cannot provide a commercial invoice (the system WILL generate a proforma invoice). Default: `N`. Required for DHL products such as A1/A5. |
| parcel_qty                | Number | 32         | false       | 3       | Number of parcels. Fill in the exact number of packages in the order. Incorrect parcel count will prevent DHL from returning accurate sub-tracking numbers and labels. Required for DHL products such as A1/A5. |
| freight_charges           | Double | 32         | false       | 48.4    | Shipping fee (customer's estimated transportation cost; supported currencies depend on logistics product + destination country). |
| currency_freight          | String | 10         | false       | USD     | Currency for shipping fee (ISO 3-letter code; supported currencies depend on logistics product + destination country). |
| declare_insurance         | Double | 32         | false       | 23.4    | Declared insurance fee. Required depending on logistics product + destination country. According to EU IOSS policy, declared value / shipping fee / insurance fee may be declared separately. Supports up to 2 decimal places. |
| currency_declare_insurance| String | 10         | false       | USD     | Currency for declared insurance fee (ISO standard; must match the import/export declaration currency). |

#### Request Payload JSON Example:

```json
{
    "4px_tracking_no": "",
    "ref_no": "YIN201803280000002",
    "business_type": "BDS",
    "duty_type": "U",
    "cargo_type": "5",
    "vat_no": "8956232323",
    "eori_no": "8956232323",
    "buyer_id": "aliwangwang",
    "sales_platform": "ebay",
    "seller_id": "cainiao",
    "logistics_service_info": {
        "logistics_product_code": "F3",
        "customs_service": "N",
        "signature_service": "N",
        "value_added_services": ""
    },
    "label_barcode": "",
    "return_info": {
        "is_return_on_domestic": "Y",
        "domestic_return_addr": {
            "first_name": "ZHANG_return",
            "last_name": "YU_return",
            "company": "fpx_return",
            "phone": "8956232659",
            "phone2": "18562356856",
            "email": "return_ZHANGYZ@4PX.COM",
            "post_code": "518000",
            "country": "CN",
            "state": "广东省__return",
            "city": "深圳市_return",
            "district": "宝安区_return",
            "street": "财富港大厦D座25楼__return",
            "house_number": "16"
        },
        "is_return_on_oversea": "Y",
        "oversea_return_addr": {
            "first_name": "ZHANG_return_oversea",
            "last_name": "YU_return_oversea",
            "company": "fpx_return_oversea",
            "phone": "8956232659",
            "phone2": "18562356856",
            "email": "ZHANGYZ@4PX_return_oversea.COM",
            "post_code": "518000",
            "country": "CN",
            "state": "state_return_oversea",
            "city": "city_return_oversea",
            "district": "district__return_oversea",
            "street": "street_return_oversea",
            "house_number": "17"
        }
    },
    "parcel_list": [
        {
            "weight": 22,
            "length": 123,
            "width": 789,
            "height": 456,
            "parcel_value": 666.66,
            "currency": "USD",
            "include_battery": "Y",
            "battery_type": "966",
            "product_list": [
                {
                    "sku_code": "iPhone6  plus_sku_code",
                    "standard_product_barcode": "56323598",
                    "product_name": "iPhone6  plus_product_name",
                    "product_description": "iPhone6  plusiPhone6  plus_product_description",
                    "product_unit_price": 3,
                    "currency": "USD",
                    "qty": 3
                }
            ],
            "declare_product_info": [
                {
                    "declare_product_code": "62323_declare_product_code",
                    "declare_product_name_cn": "手机贴膜_declare_name_cn",
                    "declare_product_name_en": "phone_declare_product_name_en",
                    "uses": "装饰_uses",
                    "specification": "dgd23_specification",
                    "component": "塑料_component",
                    "unit_net_weight": 20,
                    "unit_gross_weight": 45,
                    "material": "565323",
                    "declare_product_code_qty": 2,
                    "unit_declare_product": "个",
                    "origin_country": "中国",
                    "country_export": "越南",
                    "country_import": "新加坡",
                    "hscode_export": "45673576397",
                    "hscode_import": "12332213134",
                    "declare_unit_price_export": 23,
                    "currency_export": "USD",
                    "declare_unit_price_import": 1.25,
                    "currency_import": "USD",
                    "brand_export": "象印",
                    "brand_import": "虎牌",
                    "sales_url": "http://172.16.30.134:8038/loggerMessage/",
                    "package_remarks":"skutest"
                    
                }
            ]
        }
    ],
    "is_insure": "Y",
    "insurance_info": {
        "insure_type": "8Y",
        "insure_value": 2,
        "currency": "USD",
        "insure_person": "张三_insure_person",
        "certificate_type": "ID",
        "certificate_no": "429001198806253256",
        "category_code": "",
        "insure_product_name": "手机壳insure_product_name",
        "package_qty": "2"
    },
    "sender": {
        "first_name": "ZHANG_sender",
        "last_name": "YU_sender",
        "company": "fpx_sender",
        "phone": "8956232659",
        "phone2": "18562356856",
        "email": "ZHANGYZ_sender@4PX.COM",
        "post_code": "518000",
        "country": "CN",
        "state": "state_sender",
        "city": "city_sender",
        "district": "district_sender",
        "street": "street_sender",
        "house_number": "18",
        "certificate_info": {
            "certificate_type": "PP",
            "certificate_no": "965232323232656532",
            "id_front_url": "https://ju.taobao.com/jusp/other/mingpin/tp.htmbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
            "id_back_url": "https://ju.taobao.com/jusp/other/mingpin/tp.htmcccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc"
        }
    },
    "recipient_info": {
        "first_name": "ZHANG_recipient",
        "last_name": "YU_recipient",
        "company": "fpx_recipient",
        "phone": "8956232659",
        "phone2": "18562356856",
        "email": "ZHANGYZ_recipient@4PX.COM",
        "post_code": "518000",
        "country": "SG",
        "state": "state_recipient",
        "city": "city_recipient",
        "district": "district_recipient",
        "street": "street_recipient",
        "house_number": "19",
        "certificate_info": {
            "certificate_type": "ID",
            "certificate_no": "965232323232656532",
            "id_front_url": "https://ju.taobao.com/jusp/other/mingpin/tp.htm?spm=875.7931836/ddddddddddddddddddddddddddddddddddddddddddddd",
            "id_back_url": "https://ju.taobao.com/jusp/other/mingpin/tp.htmeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"
        }
    },
    "deliver_type_info": {
        "deliver_type": "2",
        "warehouse_code": "",
        "pick_up_info": {
            "expect_pick_up_earliest_time": "1432710115000",
            "expect_pick_up_latest_time": "1432710115000",
            "pick_up_address_info": {
                "first_name": "ZHANG_pick_up",
                "last_name": "YU_pick_up",
                "company": "fpx_pick_up",
                "phone": "8956232659",
                "phone2": "18562356856",
                "email": "ZHANGYZ_pick_up@4PX.COM",
                "post_code": "518000",
                "country": "CN",
                "state": "state_pick_up",
                "city": "city_pick_up",
                "district": "district_pick_up",
                "street": "street_pick_up",
                "house_number": "20"
            }
        },
        "express_to_4px_info": {
            "express_company": "4PXexpress_company",
            "tracking_no": "8956232323"
        },
        "self_send_to_4px_info": {
            "booking_earliest_time": "1432710115000",
            "booking_latest_time": "1432710115000"
        }
    },
    	 "label_config_info": {
            "label_size": "label_80x90",
            "response_label_format": "PDF",
            "create_logistics_label":"Y",
            "logistics_label_config": {
                 "is_print_time":"N",
                 "is_print_buyer_id":"N",
                 "is_print_pick_info":"N"
            },
            "create_package_label":"Y"
        }
}
```

### Response

| Field               | Type   | Description |
|---------------------|--------|-------------|
| result              | String | Result |
| msg                 | String | Response message |
| errors              | String | Error message |
| data                | String | Success information |
| ds_consignment_no   | String | Direct-shipment consignment number |
| 4px_tracking_no     | String | 4PX tracking number |
| label_barcode       | String | @deprecated — Label barcode number *(Note: this parameter is deprecated)* |
| ref_no              | String | Customer order number / customer reference number |
| logistics_channel_no| String | Logistics channel number. If empty, it means no logistics channel number is currently available; please call the query API later to retrieve it. |
| oda_result_sign     | String | ODA indicator (`Y`: remote area; `N`: not remote) |

#### Response JSON Example:

Failed Response:

```json
{
	"errors": [{
		"error_code": "DS000007",
		"error_msg": "Ref_no: 736017796559863808 in processing",
		"reference_code": "736017796559863808"
	}],
	"msg": "System processing failed",
	"result": "0"
}
```

Success Response:

```json
{
  "data": {
    "ds_consignment_no": "DS800900010807",
    "4px_tracking_no": "800900010807",
    "label_barcode": "",
    "logistics_channel_name": "DHL",
    "ref_no": "753256426600898560",
    "logistics_channel_no": "900900010237"
  },
  "msg": "System processing succeeded",
  "result": "1"
}
```

### Error Codes

| Error Code | Error Description                         | Solution |
|------------|--------------------------------------------|----------|
| DS000000   | Failure                                     |          |
| DS000003   | Exception                                   |          |
| DS000004   | Parameter error                             |          |
| DS000005   | Order number cannot be empty                |          |
| DS000006   | Too many operations, please try again later |          |
| DS000007   | Processing                                  |          |
| DS000008   | Error writing response                      |          |
| DS000009   | Business type cannot be empty               |          |
| DS000010   | Undefined                                   |          |
| DS000013   | Customer ID cannot be empty                 |          |
| DS000014   | This order number cannot be cancelled       |          |
| DS000015   | Request ID cannot be empty                  |          |
| DS000016   | Cancellation reason cannot be empty         |          |
| DS000017   | Order not found                             |          |
| DS000018   | Failed to update order                      |          |
| DS000019   | Returned label format is invalid            |          |
| DS000020   | Request cannot be empty                     |          |
| DS000021   | Start time for consignment creation cannot be empty |   |
| DS000022   | End time for consignment creation cannot be empty   |   |
| DS000023   | Time difference cannot exceed 7 days        |          |
| DS000024   | Data conversion failed                      |          |
| DS000025   | Error querying transfer order number        |          |
| DS000026   | Error querying order details                |          |
| DS000027   | Error retrieving XMSMARKCODE                |          |
| DS000028   | Data parameter error                        |          |
| DS000029   | Time format is correct                      |          |
| DS000030   | Invalid ByDyType in request                 |          |
| DS000031   | This product cannot be intercepted          |          |
| DS000032   | Cannot intercept when not in forecast status|          |
| DS000033   | Command cannot be empty                     |          |
| DS000034   | Command reason cannot be empty              |          |
| DS000035   | Invalid command                             |          |
| DS000036   | Interception failed; order already intercepted |        |
| DS000037   | Cancel interception failed; order not intercepted |      |
| DS000038   | Command details cannot be empty             |          |
| DS000039   | Request body JSON format error              |          |
| DS000040   | User information cannot be empty            |          |
| DS000041   | Site code cannot be empty                   |          |
| DS000042   | Invalid delivery type                       |          |
| DS000043   | Pickup code cannot be empty                 |          |
| DS000044   | Invalid business type                       |          |
| DS000045   | Incomplete customer information; XMS needs configuration | |
| DS000046   | Label for this ticket does not exist        |          |
| DS000047   | This order is not an SVIP label             |          |

---

## Query Direct-shipment Consignment (ds.xms.order.get)

Calling this API allows you to query the status, shipping label, and other related information of a direct-shipment consignment.

> **Note:** When calling the `logistics_channel_no` interface, the logistics channel number (`logistics_channel_no`) and logistics carrier (`logistics_channel_name`) will be returned only if they have values; otherwise they will be empty.  
> For some logistics products where the tracking number is changed inside the 4PX warehouse, these two fields can only be queried after the in-warehouse operations have been completed.

### Request Parameters

| Field                               | Type   | Max Length | Required | Example        | Description |
|-------------------------------------|--------|------------|----------|----------------|-------------|
| request_no                          | String | 32         | No       | (none)         | Request number |
| start_time_of_create_consignment    | Long   | 32         | No       | 1432710115000  | Consignment creation start time (*value must be converted to a long timestamp*). Maximum time span: 7 days. |
| end_time_of_create_consignment      | Long   | 32         | No       | 1432710115000  | Consignment creation end time (*value must be converted to a long timestamp*). Maximum time span: 7 days. |
| consignment_status                  | String | 32         | No       | P              | Consignment status: `P` – Predicted; `V` – Delivered/Handed Over; `H` – In warehouse / Stored; `C` – Outbound; `F` – Completed; `R` – Returned; `X` – Closed; `ALL` – All statuses (default). |

#### Request Payload JSON Example:

```json
{
  "request_no": "DJSH00718010700002",
  "start_time_of_create_consignment": null,
  "end_time_of_create_consignment": null,
  "consignment_status": null
}
```

### Response

| Field  | Type   | Max Length | Required | Example | Description |
|--------|--------|------------|----------|---------|-------------|
| result | String | —          | —        | —       | Result value: `0` indicates failure; `1` indicates success. |
| msg    | String | —          | —        | —       | Response message. |
| errors | String | —          | —        | —       | Error message. |
| data   | String | —          | —        | —       | Successful response data. |

#### Response JSON Example:

Failed Response:

```json
{
	"data": [{
		"consignment_info": {
			"4px_inbound_date": 1611810365000,
			"4px_outbound_date": 1611885462000,
			"4px_tracking_no": "305646756838",
			"consignment_create_date": 1611728635000,
			"consignment_status": "C",
			"ds_consignment_no": "DS303367756838",
			"has_check_oda": "N",
			"insure_status": "N",
			"insure_type": "",
			"is_hold_sign": "N",
			"logistics_channel_no": "420766679365559903506222909294",
			"logistics_product_code": "VN",
			"logistics_product_name": "合伙人产品4经济-带电",
			"oda_result_sign": "N",
			"ref_no": "AQ710216678CN"
		},
		"parcel_confirm_info": {
			"confirm_parcel_qty": "1",
			"confirm_parcel_weight": 80,
			"parcel_list_confirm_info": [{
				"confirm_battery_type": "",
				"confirm_charge_weight": 0,
				"confirm_high": "0",
				"confirm_include_battery": "N",
				"confirm_length": "0",
				"confirm_volume_weight": 0,
				"confirm_weight": "0",
				"confirm_width": "0",
				"currency_code": "USD",
				"parcel_total_value_confirm": "5.01"
			}]
		}
	}],
	"msg": "System processing succeeded",
	"result": "1"
}
```

---

## Cancel Direct-shipment Consignment (ds.xms.order.cancel)

Customers use this API to cancel a consignment order.
This interface is used **after the creation and forecast API has been called** (i.e., the order is in *forecasted* status), and **the goods are still in your possession**.

### Request Parameters

| Field        | Type   | Max Length | Required | Example | Description |
|--------------|--------|------------|----------|---------|-------------|
| request_no   | String | 64         | Yes      | —       | Request number |
| cancel_reason| String | 128        | Yes      | —       | Reason for cancellation |

#### Request Payload JSON Example:

```json
{
  "cancel_reason": "test",
  "request_no": "3000210210"
}
```

### Response

| Field  | Type   | Max Length | Required | Example | Description |
|--------|--------|------------|----------|---------|-------------|
| result | String | —          | —        | —       | Result value: `0` indicates failure; `1` indicates success |
| msg    | String | —          | —        | —       | Response message |
| errors | String | —          | —        | —       | Error message |
| data   | String | —          | —        | —       | Successful response data |

#### Response JSON Example:

Failed Response:

```json
{
	"result": "0",
	"msg": "System processing failed",
	"errors": [{
		"error_code": "0",
		"error_msg": "Can not find this order",
		"error_data": null,
		"reference_code": "DJSH00717122700004"
	}],
	"data": null
}
```

Success Response:

```json
{
	"result": "1",
	"msg": "System processing succeeded",
	"errors": null,
	"data": null
}
```

---

## Apply / Cancel Order Interception (ds.xms.order.hold)

When an interception request is successfully submitted, the order list will display a successful interception flag.  
After 4PX successfully intercepts the order, it will be handled as an *exception case*, and you will be able to view the intercepted order under the exception-handling section.

### Request Parameters

| Field        | Type   | Max Length | Required | Example | Description |
|--------------|--------|------------|----------|---------|-------------|
| request_no   | String | 64         | Yes      | —       | Request number |
| cancel_reason| String | 128        | Yes      | —       | Reason for cancellation |

#### Request Payload JSON Example:

```json
{
	"request_no": "3000210210",
	"is_hold": "Y",
	"hold_reason": "Order cancellation"
}
```

### Response

| Field  | Type   | Max Length | Required | Example | Description |
|--------|--------|------------|----------|---------|-------------|
| result | String | —          | —        | —       | Result value: `0` indicates failure; `1` indicates success |
| msg    | String | —          | —        | —       | Response message |
| errors | String | —          | —        | —       | Error message |
| data   | String | —          | —        | —       | Successful response data |

#### Response JSON Example:

Failed Response:

```json
{
	"result":"0",
	"msg":"System processing failed",
	"errors":[
		{
			"errorCode":null,
			"errorMsg":null,
			"errorData":null,
			"referenceCode":null,
			"error_code":"DS000031",
			"error_msg":"This product can not be intercepted",
			"error_data":null,
			"reference_code":"UG044286942CN"
		}
	],
	"data":null
}
```

Success Response:

```json
{
	"result": "1",
	"msg": "System processing succeeded",
	"errors": null,
	"data": null
}
```

---

## Update Carrier Tracking Number & Label (ds.xms.order.updateByLabel)

This API is used in scenarios where certain logistics products require the last-mile carrier tracking number and label to be submitted separately after the logistics order has been created.

**Note:** This interface only supports orders in the “forecasted” (pre-alerted) status.

### Request Parameters

| Field                    | Type   | Max Length | Required | Example          | Description |
|--------------------------|--------|------------|----------|------------------|-------------|
| request_no               | String | 64         | Yes      | 123456788990     | Request number (supports 4PX tracking number / customer order number / carrier tracking number) |
| label_barcode            | String | 64         | Yes      | 323233456433     | The label barcode to be updated — i.e., the last-mile carrier tracking number to update |
| service_provider_label_url | String | 128      | Yes      | https://4px456.pdf | URL link to the carrier’s label |

#### Request Payload JSON Example:

```json
{
	"request_no": "4PX1233444",
	"label_barcode": "1233455555",
	"service_provider_label_url": "https://4px456.pdf"
}
```

### Response

| Field  | Type   | Max Length | Required | Example | Description |
|--------|--------|------------|----------|---------|-------------|
| result | String | —          | —        | —       | Result value: `0` indicates failure; `1` indicates success |
| msg    | String | —          | —        | —       | Response message |
| errors | String | —          | —        | —       | Error message |
| data   | String | —          | —        | —       | Successful response data |

#### Response JSON Example:

Success Response:

```json
{
	"result": "1",
	"msg": "System processing succeeded"
}
```

---

## Logistics Product Query (ds.xms.logistics_product.getlist)

Logistics product query, use this API to get which 4PX products can be selected as fulfillment options

### Request Parameters

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `transport_mode` | String | 1 | true | 1 | Transportation mode: `1` All modes; `2` International Express; `3` International Small Parcel; `4` Dedicated Line; `5` LianYouTong; `6` Others |
| `source_country_code` | String | 2 | false | CN | Origin — two-letter country code. *This filter is currently unavailable.* |
| `source_warehouse_code` | String | 20 | false |  | Origin — warehouse code. *This filter is currently unavailable.* |
| `dest_country_code` | String | 2 | false | US | Destination — two-letter country code. *This filter is currently unavailable.* |

#### Request Payload JSON Example:

```json
{
	"transport_mode": "1"
}
```

### Response

#### Response Parameters

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `result` | String | — | — | — | Result value: `0` = failure, `1` = success |
| `msg` | String | — | — | — | Response message |
| `errors` | String | — | — | — | Error message |
| `data` | String | — | — | — | Successful data |

#### Response Data

The following response data is from the `data` key of response parameters.

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `logistics_product_code` | String | — | — | — | Logistics product code |
| `logistics_product_name_cn` | String | — | — | — | Logistics product name (Chinese) |
| `logistics_product_name_en` | String | — | — | — | Logistics product name (English) |
| `transport_mode` | String | 2 | — | — | Transportation mode: `2` International Express; `3` International Small Parcel; `4` Dedicated Line; `5` LianYouTong; `6` Others |
| `with_battery` | String | — | — | N | Whether batteries are allowed (`Y` = allowed, `N` = not allowed) |
| `order_track` | String | — | — | Y/N | Trackable (`Y` = trackable, `N` = not trackable) |
| `billing_volume_weight` | String | — | — | Y/N | Whether volumetric weight is included in billing (`Y` = included, `N` = not included) |
| `surface_mail` | String | — | — | Y/N | Whether it is surface mail (`Y` = surface mail, `N` = non-surface mail) |

#### Response JSON Example:

```json
{
	"data": [
		{
			"billing_volume_weight": "Y",
			"logistics_product_code": "A2",
			"logistics_product_name_cn": "4PX标准专线",
			"logistics_product_name_en": "4PX  Express",
			"order_track": "Y",
			"surface_mail": "N"
		},
		{
			"billing_volume_weight": "Y",
			"logistics_product_code": "A5",
			"logistics_product_name_cn": "DHL华东超值大货",
			"logistics_product_name_en": "DHL EastChina Heavy",
			"order_track": "Y",
			"surface_mail": "N"
		},
		{
			"billing_volume_weight": "N",
			"logistics_product_code": "A6",
			"logistics_product_name_cn": "4PX联邮通挂号",
			"logistics_product_name_en": "LYT GH",
			"order_track": "Y",
			"surface_mail": "N"
		}
	]
}
```

---

## Estimated Cost Query / Freight Calculation (ds.xms.estimated_cost.get)

Estimated Cost Query / Freight Calculation based on region and customer address

### Request Parameters

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `request_no` | String | 64 | specific_true | RV511390022CN | Request number (supports 4PX order no., tracking no., customer order no.). If this field is filled, all other request fields will not take effect. |
| `country_code` | String | 2 | specific_true | CN | Destination country code (required when request_no is not filled). |
| `weight` | String | 6 | specific_true | 1200 | Actual weight (in grams; required when request_no is not filled). Must be less than 1,000,000g. |
| `length` | String | 3 | false | 10 | Length (cm). If any of length/width/height is filled, the other two must also be filled. Must be less than 1000 cm and keep 2 decimal places. |
| `width` | String | 3 | false | 10 | Width (cm). Same completion rule as length. Must be less than 1000 cm and keep 2 decimal places. |
| `height` | String | 3 | false | 10 | Height (cm). Same completion rule as length. Must be less than 1000 cm and keep 2 decimal places. |
| `cargocode` | String | 2 | false | P | Cargo type (`P` = Parcel; `D` = Document). Default: `P`. |
| `logistics_product_code` | List | 2 | false | A1 | List of logistics product codes. If filled, only the specified products' estimation results will be returned. Max 200 products. |
| `recipient_post_code` | String | 32 | false | 223 | Postal code. |

#### Request Payload JSON Example:

```json
{
	"transport_mode": "1"
}
```

### Response

#### Response Parameters

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `result` | String | — | — | — | Result value: `0` = failure, `1` = success |
| `msg` | String | — | — | — | Response message |
| `errors` | String | — | — | — | Error message |
| `data` | String | — | — | — | Successful data |

#### Response Data

The following response data is from the `data` key of response parameters.

| Field | Type | Max Length | Required | Example | Description |
|-------|--------|------------|----------|---------|-------------|
| `logistics_product_code` | String | — | — | — | Logistics product code |
| `logistics_product_name_cn` | String | — | — | — | Logistics product name (Chinese) |
| `logistics_product_name_en` | String | — | — | — | Logistics product name (English) |
| `transport_mode` | String | 2 | — | — | Transportation mode: `2` International Express; `3` International Small Parcel; `4` Dedicated Line; `5` LianYouTong; `6` Others |
| `with_battery` | String | — | — | N | Whether batteries are allowed (`Y` = allowed, `N` = not allowed) |
| `order_track` | String | — | — | Y/N | Trackable (`Y` = trackable, `N` = not trackable) |
| `billing_volume_weight` | String | — | — | Y/N | Whether volumetric weight is included in billing (`Y` = included, `N` = not included) |
| `surface_mail` | String | — | — | Y/N | Whether it is surface mail (`Y` = surface mail, `N` = non-surface mail) |

#### Response JSON Example:

```json
{
	"data": [
		{
			"billing_volume_weight": "Y",
			"logistics_product_code": "A2",
			"logistics_product_name_cn": "4PX标准专线",
			"logistics_product_name_en": "4PX  Express",
			"order_track": "Y",
			"surface_mail": "N"
		},
		{
			"billing_volume_weight": "Y",
			"logistics_product_code": "A5",
			"logistics_product_name_cn": "DHL华东超值大货",
			"logistics_product_name_en": "DHL EastChina Heavy",
			"order_track": "Y",
			"surface_mail": "N"
		},
		{
			"billing_volume_weight": "N",
			"logistics_product_code": "A6",
			"logistics_product_name_cn": "4PX联邮通挂号",
			"logistics_product_name_en": "LYT GH",
			"order_track": "Y",
			"surface_mail": "N"
		}
	]
}
```